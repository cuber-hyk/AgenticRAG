version: "3.9"
services:
  weaviate:
    image: semitechnologies/weaviate:1.24.6
    ports:
      - "8080:8080"
    environment:
      - QUERY_DEFAULTS_LIMIT=20
      - ENABLE_MODULES=text2vec-transformers
      - TRANSFORMERS_INFERENCE_API=http://t2v-transformers:8080
      - CLUSTER_HOSTNAME=node1
    depends_on:
      - t2v-transformers
  t2v-transformers:
    image: semitechnologies/transformers-inference:sentence-transformers-multi-qa-MiniLM-L6-cos-v1
    environment:
      - ENABLE_CUDA=false
  backend:
    build: ./backend
    environment:
      - WEAVIATE_URL=http://weaviate:8080
      - WEAVIATE_CLASS=Documents
      - SILICONCLOUD_API_KEY=${SILICONCLOUD_API_KEY}
    ports:
      - "8000:8000"
    depends_on:
      - weaviate
  frontend:
    build: ./frontend
    ports:
      - "5173:80"
    depends_on:
      - backend
